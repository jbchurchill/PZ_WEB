var map,console,require;var passedCenter,passedX,passedY,zoomLevel;require(["dojo/dom","dojo/on","esri/Color","dojo/keys","dojo/parser","esri/layers/ArcGISDynamicMapServiceLayer","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/ImageParameters","esri/dijit/BasemapGallery","esri/config","esri/sniff","esri/map","esri/graphic","esri/tasks/GeometryService","esri/dijit/Scalebar","esri/dijit/Basemap","esri/SnappingManager","esri/dijit/Measurement","esri/geometry/webMercatorUtils","esri/geometry/Point","esri/layers/FeatureLayer","esri/renderers/SimpleRenderer","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/SimpleMarkerSymbol","dojo/store/Memory","dijit/form/ComboBox","dijit/registry","dijit/layout/BorderContainer","dijit/layout/ContentPane","dijit/TitlePane","esri/dijit/Geocoder","dojo/domReady!"],function(f,J,r,F,H,s,y,Z,N,x,i,q,h,W,D,M,R,w,I,A,P,B,C,d,aa,E,z,U,X,k,c,Q){H.parse();var j,b,g,n,m,G,a,V,e,p,v,L,t;var u,T;x.defaults.io.proxyUrl="/proxy";x.defaults.io.alwaysUseProxy=false;x.defaults.geometryService=new W("https://tasks.arcgisonline.com/ArcGIS/rest/services/Geometry/GeometryServer");function S(){var ac=dijit.byId("mapSelect").get("value"),ad,ab,ae;switch(ac){case"Measurement":ae="_self";ad="measure.php";break;case"Planning and Zoning":ad="pz_map.php";ae="_blank";break;case"Flood Hazard":ad="FEMA_map.php";ae="_blank";break;case"Sensitive Areas":ad="sensitive.php";ae="_blank";break;case"Printable":ad="printable.php";ae="_blank";break}var ab=ad+"?px="+passedX+"&py="+passedY+"&zl="+zoomLevel;window.open(ab,ae)}passedCenter=[passedX,passedY];U.byId("launchButton").on("click",S);function l(){dojo.connect(map,"onExtentChange",K)}map=new q("map",{basemap:"streets",center:passedCenter,zoom:zoomLevel});function O(){var ae,ad,ai,ah,af,ab,ag,ac;ae=document.getElementById("textLatLong").value;ae=ae.replace(/\s+/g,"");ad=ae.indexOf(",");if(ad>0){ai=parseFloat(ae.slice(0,ad));ah=parseFloat(ae.substring(ad+1));af=new aa(aa.STYLE_SQUARE,12,new C(C.STYLE_SOLID,new r([10,10,10,0.75]),1),new r([255,0,0,0.5]));ab=new A(ah,ai,map.spatialRefernce);ag=new h(ab,af,null,null);map.graphics.add(ag);if(ag.geometry.type==="point"){ac=map.getMaxZoom();map.centerAndZoom(ag.geometry,ac-1)}else{map.setExtent(graphicsUtils.graphicsExtent([ag]))}}else{return""}}function Y(ac){var ab=document.getElementById("textLatLong");ab.value=ac.coords.latitude+", "+ac.coords.longitude}function o(){map.graphics.clear();var ab=document.getElementById("centroid");if(navigator.geolocation){navigator.geolocation.getCurrentPosition(Y)}else{ab.innerHTML="Geolocation is not supported by this browser."}}J(f.byId("getLocationButton"),"click",o);j=new N({showArcGISBasemaps:true,map:map},"basemapGallery");b=new D({map:map,attachTo:"bottom-right",scalebarStyle:"line",scalebarUnit:"english"});map.on("load",l);J(f.byId("submitLatLongButton"),"click",O);var u=new E({data:[{name:"Flood Hazard",id:"FEMA",baseURL:"FEMA_map.php"},{name:"Measurement",id:"MSMT",baseURL:"measure.php"},{name:"Planning and Zoning",id:"PZMAP",baseURL:"pz_map.php"},{name:"Sensitive Areas",id:"SENSI",baseURL:"sensitive.php"},{name:"Printable",id:"PRINT",baseURL:"printable.php"}]});var T=new z({id:"mapSelect",name:"map",value:"Measurement",store:u,searchAttr:"name"},"mapSelect").startup();function K(ad){var ac=I.webMercatorToGeographic(map.extent.getCenter());passedX=parseFloat(ac.x.toFixed(5));passedY=parseFloat(ac.y.toFixed(5));zoomLevel=map.getLevel();var ab=document.getElementById("centroid");ab.innerHTML="Latitude: "+passedY+"<br />Longitude: "+passedX}g=new esri.layers.ArcGISTiledMapServiceLayer("https://geodata.md.gov/imap/rest/services/Imagery/MD_SixInchImagery/ImageServer");mdImage2011=new esri.layers.ArcGISTiledMapServiceLayer("https://imagery.geodata.md.gov/imap/rest/services/SixInch/SixInchImagery2011_2013/MapServer");n=new esri.dijit.Basemap({layers:[g],title:"MD 2014 Imagery",thumbnailUrl:"https://maps.garrettcounty.org/arcgis/images/image2014.png"});mdImageBasemap2011=new esri.dijit.Basemap({layers:[mdImage2011],title:"MD 2011 Imagery",thumbnailUrl:"https://maps.garrettcounty.org/arcgis/images/image_v2.png"});j.add(n);j.add(mdImageBasemap2011);j.startup();j.on("error",function(ab){console.log("basemap gallery error:  ",ab)});m=new d("solid",new C("solid",new r([195,176,23]),2),null);G=new Z();G.layerIds=[0,2,3,5,7];G.layerOption=Z.LAYER_OPTION_SHOW;a=new s("https://maps.garrettcounty.org/arcweb/rest/services/P_and_Z/Parcels_and_Zoning/MapServer",{imageParameters:G,opacity:0.55});map.addLayer(a);V=new P("https://maps.garrettcounty.org/arcweb/rest/services/P_and_Z/Parcels_and_Zoning/MapServer/7",{mode:P.MODE_ONDEMAND,outFields:["*"]});V.setRenderer(new B(m));map.addLayers([V]);e=map.enableSnapping({snapKey:i("mac")?F.META:F.CTRL});p=[{layer:V}];e.setLayerInfos(p);v=new w({map:map},f.byId("measurementDiv"));v.startup();L=[{url:"https://geodata.md.gov/imap/rest/services/GeocodeServices/MD_CompositeLocatorWithEsri/GeocodeServer",name:"MDiMap Composite Locator",singleLineFieldName:"SingleLine"}];t=new Q({map:map,geocoders:L,arcgisGeocoder:false},"geosearch");t.startup()});