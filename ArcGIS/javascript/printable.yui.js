var app={};var mpArray;var passedCenter;app.map=null;app.toolbar=null;app.tool=null;app.symbols=null;app.printer=null;require(["esri/map","esri/toolbars/draw","esri/toolbars/edit","esri/dijit/Print","esri/dijit/Geocoder","esri/dijit/BasemapGallery","esri/geometry/webMercatorUtils","esri/geometry/Point","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/ArcGISDynamicMapServiceLayer","esri/layers/FeatureLayer","esri/layers/ImageParameters","esri/layers/GraphicsLayer","esri/tasks/PrintTemplate","esri/tasks/LegendLayer","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/TextSymbol","esri/symbols/Font","esri/renderers/SimpleRenderer","esri/graphic","esri/config","dojo/_base/array","esri/Color","dojo/parser","dojo/query","dojo/dom","dojo/on","dojo/dom-construct","dojo/store/Memory","dijit/registry","dijit/form/CheckBox","dijit/form/ComboBox","dijit/form/Button","dijit/layout/BorderContainer","dijit/layout/ContentPane","dijit/TitlePane","dojox/layout/ExpandoPane","dojo/domReady!"],function(w,ak,aq,m,S,al,ax,f,T,ah,ac,av,V,ao,s,A,X,B,J,ap,n,ay,O,g,x,R,N,y,G,aa,o,Z,ar,t,j,p){R.parse();O.defaults.io.proxyUrl="/proxy";var i,ab,M,ag,h;var H=false;passedCenter=[passedX,passedY];app.map=new w("map",{basemap:"streets",center:passedCenter,zoom:zoomLevel});function L(){var aD,aC,aH,aG,aE,aA,aF,aB;aD=document.getElementById("textLatLong").value;aD=aD.replace(/\s+/g,"");aC=aD.indexOf(",");if(aC>0){aH=parseFloat(aD.slice(0,aC));aG=parseFloat(aD.substring(aC+1));aE=new A(A.STYLE_SQUARE,12,new X(X.STYLE_SOLID,new x([10,10,10,0.75]),1),new x([255,0,0,0.5]));aA=new f(aG,aH,map.spatialRefernce);aF=new ay(aA,aE,null,null);app.map.graphics.add(aF);if(aF.geometry.type==="point"){aB=app.map.getMaxZoom();app.map.centerAndZoom(aF.geometry,aB-1)}else{app.map.setExtent(graphicsUtils.graphicsExtent([aF]))}}else{return""}}function a(aB){var aA=document.getElementById("textLatLong");aA.value=aB.coords.latitude+", "+aB.coords.longitude}function P(){app.map.graphics.clear();var aA=document.getElementById("centroid");if(navigator.geolocation){navigator.geolocation.getCurrentPosition(a)}else{aA.innerHTML="Geolocation is not supported by this browser."}}G(y.byId("getLocationButton"),"click",P);app.map.on("load",function(){app.toolbar=new ak(app.map);app.toolbar.on("draw-end",D);app.map.on("mouse-move",aj);app.map.on("mouse-drag",aj);dojo.connect(app.map,"onExtentChange",v);G(y.byId("submitLatLongButton"),"click",L);Y(app.map)});function aw(){app.map.graphics.clear()}function aj(aA){var aB=ax.webMercatorToGeographic(aA.mapPoint);y.byId("coordsinfo").innerHTML=aB.y.toFixed(5)+", "+aB.x.toFixed(5);mpArray=[aB.x.toFixed(5),aB.y.toFixed(5)]}function at(){app.toolbar=new ak(app.map);af("label");app.toolbar.on("draw-end",D);G.once(y.byId("map"),"click",aj)}i=new al({showArcGISBasemaps:true,map:app.map},"basemapGallery");mdImagelayer=new esri.layers.ArcGISTiledMapServiceLayer("https://geodata.md.gov/imap/rest/services/Imagery/MD_SixInchImagery/ImageServer");mdImage2011=new esri.layers.ArcGISTiledMapServiceLayer("https://imagery.geodata.md.gov/imap/rest/services/SixInch/SixInchImagery2011_2013/MapServer");mdImageBasemap=new esri.dijit.Basemap({layers:[mdImagelayer],title:"MD 2014 Imagery",thumbnailUrl:"https://maps.garrettcounty.org/arcgis/images/image2014.png"});mdImageBasemap2011=new esri.dijit.Basemap({layers:[mdImage2011],title:"MD 2011 Imagery",thumbnailUrl:"https://maps.garrettcounty.org/arcgis/images/image_v2.png"});i.add(mdImageBasemap);i.add(mdImageBasemap2011);i.startup();i.on("error",function(aA){console.log("basemap gallery error:  ",aA)});ab=new s();ab.layerId="Zoning";M=new s();M.layerId="Protected Species";ag=new s();ag.layerId="Growth Areas";h=new s();h.layerId="Edge of Pavement";legSourceWater=new s();legSourceWater.layerId="Source Water Prot. Areas";var am,az,F,C,U,au,W,q,b,ad,d,e,r;var k=0;function c(){if(k>0){app.printer.destroy()}k+=1;var aB;var aF=Z.byId("mapTitle");var aA="Data from Garrett County Office of Planning and Land Management. Accuracy is not guaranteed (see https://maps.garrettcounty.org/).";var aC="Title and Graphics created by User at "+ip;aB=aF.get("value");var aE=[{name:"Letter ANSI A Landscape",label:"Landscape (PDF)",format:"pdf",options:{legendLayers:[ab,M,ag,h,legSourceWater],scalebarUnit:"Miles",titleText:aB+", Landscape PDF",copyrightText:aC,authorText:aA}},{name:"Letter ANSI A Portrait",label:"Portrait (Image)",format:"jpg",options:{legendLayers:[ab,M,ag,h,legSourceWater],scaleBarUnit:"Miles",titleText:aB+", Portrait JPG",copyrightText:aC,authorText:aA}},{name:"Letter ANSI A Landscape",label:"Landscape (Image)",format:"jpg",options:{legendLayers:[ab,M,ag,h,legSourceWater],scaleBarUnit:"Miles",titleText:aB+", Landscape JPG",copyrightText:aC,authorText:aA}},{name:"Letter ANSI A Portrait",label:"Portrait (PDF)",format:"pdf",options:{legendLayers:[ab,M,ag,h,legSourceWater],scaleBarUnit:"Miles",titleText:aB+", Portrait PDF",copyrightText:aC,authorText:aA}}];var aD=g.map(aE,function(aH){var aG=new ao();aG.layout=aH.name;aG.label=aH.label;aG.format=aH.format;aG.layoutOptions=aH.options;return aG});app.printer=new m({map:app.map,templates:aD,url:"https://maps.garrettcounty.org/arcweb/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task"},y.byId("printButton"));app.printer.startup()}G(y.byId("prepMap"),"click",c);G(y.byId("clearGraphics"),"click",aw);G(y.byId("textLabel"),"click",at);var u,E,ae,K,ai,I;u=new av();u.layerIds=[1,4,5,6,7];u.layerOption=av.LAYER_OPTION_SHOW;E=new av();E.layerIds=[2,6];E.layerOption=av.LAYER_OPTION_SHOW;I="RDNAMELOCAL";ae=new av();ae.layerIds=[2,3,4,5,6,7,8,9];ae.layerOption=av.LAYER_OPTION_SHOW;K=new av();K.layerIds=[11,12,13,14];K.layerOption=av.LAYER_OPTION_SHOW;am=new ah("https://maps.garrettcounty.org/arcweb/rest/services/P_and_Z/Parcels_and_Zoning/MapServer",{imageParameters:E,opacity:0.75,id:"Parcels & Addresses"});az=new ac("https://maps.garrettcounty.org/arcweb/rest/services/P_and_Z/Parcels_and_Zoning/MapServer/3",{mode:ac.MODE_ONDEMAND,id:"Cell Towers"});F=new ac("https://maps.garrettcounty.org/arcweb/rest/services/P_and_Z/Parcels_and_Zoning/MapServer/1",{mode:ac.MODE_ONDEMAND,id:"Wind Turbines"});C=new ac("https://maps.garrettcounty.org/arcweb/rest/services/P_and_Z/Parcels_and_Zoning/MapServer/5",{mode:ac.MODE_ONDEMAND,outFields:[I],showLabels:true,id:"Street Centerlines"});U=new ac("https://maps.garrettcounty.org/arcweb/rest/services/Sensitive_Areas/Sensitive_Areas/MapServer/1",{mode:ac.MODE_ONDEMAND,id:"Perennial Streams"});au=new ac("https://maps.garrettcounty.org/arcweb/rest/services/P_and_Z/Parcels_and_Zoning/MapServer/11",{mode:ac.MODE_ONDEMAND,opacity:0.3,id:"Zoning"});W=new ac("https://maps.garrettcounty.org/arcweb/rest/services/Sensitive_Areas/Sensitive_Areas/MapServer/4",{mode:ac.MODE_ONDEMAND,opacity:0.45,id:"Source Water Prot. Areas"});q=new ac("https://maps.garrettcounty.org/arcweb/rest/services/Sensitive_Areas/Sensitive_Areas/MapServer/6",{mode:ac.MODE_ONDEMAND,opacity:0.45,id:"Protected Species"});b=new ac("https://maps.garrettcounty.org/arcweb/rest/services/Sensitive_Areas/Sensitive_Areas/MapServer/7",{mode:ac.MODE_ONDEMAND,opacity:0.75,id:"Growth Areas"});ad=new ac("https://maps.garrettcounty.org/arcweb/rest/services/FEMA/FEMA/MapServer/2",{mode:ac.MODE_ONDEMAND,id:"Flood Hazard",opacity:0.75});d=new ac("https://maps.garrettcounty.org/arcweb/rest/services/Contours_and_Plan/Contours_and_Plan/MapServer/0",{mode:ac.MODE_ONDEMAND,opacity:0.75,id:"Building Footprints"});e=new ah("https://maps.garrettcounty.org/arcweb/rest/services/Contours_and_Plan/Contours_and_Plan/MapServer",{imageParameters:ae,opacity:0.75,id:"Edge of Pavement"});r=new ah("https://maps.garrettcounty.org/arcweb/rest/services/Contours_and_Plan/Contours_and_Plan/MapServer",{imageParameters:K,opacity:0.75,id:"Contours"});app.map.addLayers([am,az,F,C,U,au,W,q,b,ad,d,e,r]);g.forEach(["Parcels & Addresses","Cell Towers","Wind Turbines","Street Centerlines","Perennial Streams","Zoning","Source Water Prot. Areas","Protected Species","Growth Areas","Flood Hazard","Building Footprints","Edge of Pavement","Contours"],function(aB){new ar({id:"cb_"+aB,name:"cb_"+aB,checked:true,onChange:function(aC){aC?app.map.getLayer(this.id.split("_")[1]).show():app.map.getLayer(this.id.split("_")[1]).hide()}},aa.create("input",{id:"lyr_"+aB})).placeAt(y.byId("layerToggle"));var aA=aa.create("label",{"for":"cb_"+aB,innerHTML:aB});aa.place(aA,y.byId("layerToggle"));aa.place(aa.create("br"),y.byId("layerToggle"))});app.symbols={};app.symbols.point=new A("square",10,new X(),new x([0,255,0,0.75]));app.symbols.polyline=new X("solid",new x([255,128,0]),2);app.symbols.polygon=new B().setColor(new x([255,255,0,0.25]));app.symbols.circle=new B().setColor(new x([0,0,180,0.25]));app.symbols.line=new X("solid",new x([180,10,80]),2);N(".drawing").forEach(function(aB){var aA=new j({label:aB.innerHTML,onClick:function(){af(this.id)}},aB)});var Q,l;Q=new o({data:[{name:"Flood Hazard",id:"FEMA",baseURL:"FEMA_map.php"},{name:"Measurement",id:"MSMT",baseURL:"measure.php"},{name:"Planning and Zoning",id:"PZMAP",baseURL:"pz_map.php"},{name:"Sensitive Areas",id:"SENSI",baseURL:"sensitive.php"},{name:"Printable",id:"PRINT",baseURL:"printable.php"}]});l=new t({id:"mapSelect",name:"map",value:"Printable",store:Q,searchAttr:"name"},"mapSelect").startup();function an(){var aB=dijit.byId("mapSelect").get("value"),aC,aA,aD;switch(aB){case"Measurement":aD="_blank";aC="measure.php";break;case"Planning and Zoning":aC="pz_map.php";aD="_blank";break;case"Flood Hazard":aC="FEMA_map.php";aD="_blank";break;case"Sensitive Areas":aC="sensitive.php";aD="_blank";break;case"Printable":aC="printable.php";aD="_self";break}aA=aC+"?px="+passedX+"&py="+passedY+"&zl="+zoomLevel;window.open(aA,aD)}Z.byId("launchButton").on("click",an);function v(aC){var aB=ax.webMercatorToGeographic(aC.getCenter());passedX=parseFloat(aB.x.toFixed(5));passedY=parseFloat(aB.y.toFixed(5));zoomLevel=app.map.getLevel();var aA=document.getElementById("centroid");aA.innerHTML="Latitude: "+passedY+"<br />Longitude: "+passedX}function af(aA){if(aA==="label"){app.symbols.point=new A("circle",10,new X(),new x([255,0,0,0.75]));aA="point";esri.bundle.toolbars.draw.addPoint="Add a text label";H=true}else{if(aA==="point"){app.symbols.point=new A("square",10,new X(),new x([0,255,0,0.75]));esri.bundle.toolbars.draw.addPoint="Click to add a point";H=false}else{if(aA==="arrow"){app.symbols.arrow=new B().setColor(new x([0,0,180,0.25]))}else{if(aA==="rectangle"){app.symbols.rectangle=new B().setColor(new x([0,180,39,0.25]))}else{H=false}}}}app.tool=aA.replace("freehand","");app.toolbar.activate(aA);app.map.hideZoomSlider()}function Y(){dojo.connect(dijit.byId("map"),"resize",app.map,app.map.resize);aq=new esri.toolbars.Edit(app.map);dojo.connect(app.map.graphics,"onClick",function(aA){dojo.stopEvent(aA);z(aA.graphic)});dojo.connect(app.map,"onClick",function(aA){aq.deactivate()})}function z(aB){var aA={allowAddVertices:true,allowDeleteVertices:true};aq.activate(esri.toolbars.Edit.EDIT_VERTICES|esri.toolbars.Edit.ROTATE,aB,aA)}function D(aB){var aG,aE,aD,aF,aH,aA;var aC=new ap("20px",ap.STYLE_NORMAL,ap.VARIANT_NORMAL,ap.WEIGHT_BOLDER,"Ariel");app.toolbar.deactivate();app.map.showZoomSlider();if(H){aG=prompt("Enter a Text Label","");aD=Z.byId("includeCoords");if(aD.get("checked")){aF="Lat: "+mpArray[1]+", Long: "+mpArray[0]+"  -  "+aG}else{aF=aG}aE=new J(aF,aC,new x([0,0,0]));aH=new ay(aB.geometry,aE);aA=new ay(aB.geometry,app.symbols[app.tool]);app.map.graphics.add(aH);app.map.graphics.add(aA)}else{aH=new ay(aB.geometry,app.symbols[app.tool]);app.map.graphics.add(aH)}H=false}geocoders=[{url:"https://geodata.md.gov/imap/rest/services/GeocodeServices/MD_CompositeLocator/GeocodeServer",name:"MDiMap Composite Locator",singleLineFieldName:"SingleLine"}];geocoder=new S({map:app.map,geocoders:geocoders,arcgisGeocoder:false},"geosearch");geocoder.startup()});