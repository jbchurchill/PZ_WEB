var app={};var mpArray;var passedCenter;app.map=null;app.toolbar=null;app.tool=null;app.symbols=null;app.printer=null;require(["esri/map","esri/toolbars/draw","esri/toolbars/edit","esri/dijit/Print","esri/dijit/Geocoder","esri/dijit/BasemapGallery","esri/geometry/webMercatorUtils","esri/geometry/Point","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/ArcGISDynamicMapServiceLayer","esri/layers/FeatureLayer","esri/layers/ImageParameters","esri/layers/GraphicsLayer","esri/tasks/PrintTemplate","esri/tasks/LegendLayer","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/TextSymbol","esri/symbols/Font","esri/renderers/SimpleRenderer","esri/graphic","esri/config","dojo/_base/array","esri/Color","dojo/parser","dojo/query","dojo/dom","dojo/on","dojo/dom-construct","dojo/store/Memory","dijit/registry","dijit/form/CheckBox","dijit/form/ComboBox","dijit/form/Button","dijit/layout/BorderContainer","dijit/layout/ContentPane","dijit/TitlePane","dojox/layout/ExpandoPane","dojo/domReady!"],function(w,al,ar,m,S,am,ay,f,T,ai,ad,aw,W,ap,s,A,Y,B,J,aq,n,az,O,g,x,R,N,y,G,ab,o,aa,at,t,j,p){R.parse();O.defaults.io.proxyUrl="/proxy";var i,ac,M,ah,h;var H=false;passedCenter=[passedX,passedY];app.map=new w("map",{basemap:"streets",center:passedCenter,zoom:zoomLevel});function L(){var aF,aE,aJ,aI,aG,aC,aH,aD;aF=document.getElementById("textLatLong").value;aF=aF.replace(/\s+/g,"");aE=aF.indexOf(",");if(aE>0){aJ=parseFloat(aF.slice(0,aE));aI=parseFloat(aF.substring(aE+1));aG=new A(A.STYLE_SQUARE,12,new Y(Y.STYLE_SOLID,new x([10,10,10,0.75]),1),new x([255,0,0,0.5]));aC=new f(aI,aJ,map.spatialRefernce);aH=new az(aC,aG,null,null);app.map.graphics.add(aH);if(aH.geometry.type==="point"){aD=app.map.getMaxZoom();app.map.centerAndZoom(aH.geometry,aD-1)}else{app.map.setExtent(graphicsUtils.graphicsExtent([aH]))}}else{return""}}function a(aD){var aC=document.getElementById("textLatLong");aC.value=aD.coords.latitude+", "+aD.coords.longitude}function P(){app.map.graphics.clear();var aC=document.getElementById("centroid");if(navigator.geolocation){navigator.geolocation.getCurrentPosition(a)}else{aC.innerHTML="Geolocation is not supported by this browser."}}G(y.byId("getLocationButton"),"click",P);app.map.on("load",function(){app.toolbar=new al(app.map);app.toolbar.on("draw-end",D);app.map.on("mouse-move",ak);app.map.on("mouse-drag",ak);dojo.connect(app.map,"onExtentChange",v);G(y.byId("submitLatLongButton"),"click",L);Z(app.map)});function ax(){app.map.graphics.clear()}function ak(aC){var aD=ay.webMercatorToGeographic(aC.mapPoint);y.byId("coordsinfo").innerHTML=aD.y.toFixed(5)+", "+aD.x.toFixed(5);mpArray=[aD.x.toFixed(5),aD.y.toFixed(5)]}function au(){app.toolbar=new al(app.map);ag("label");app.toolbar.on("draw-end",D);G.once(y.byId("map"),"click",ak)}i=new am({showArcGISBasemaps:true,map:app.map},"basemapGallery");mdImagelayer=new esri.layers.ArcGISTiledMapServiceLayer("https://geodata.md.gov/imap/rest/services/Imagery/MD_SixInchImagery/ImageServer");mdImage2011=new esri.layers.ArcGISTiledMapServiceLayer("https://imagery.geodata.md.gov/imap/rest/services/SixInch/SixInchImagery2011_2013/MapServer");mdImageBasemap=new esri.dijit.Basemap({layers:[mdImagelayer],title:"MD 2014 Imagery",thumbnailUrl:"https://maps.garrettcounty.org/arcgis/images/image2014.png"});mdImageBasemap2011=new esri.dijit.Basemap({layers:[mdImage2011],title:"MD 2011 Imagery",thumbnailUrl:"https://maps.garrettcounty.org/arcgis/images/image_v2.png"});i.add(mdImageBasemap);i.add(mdImageBasemap2011);i.startup();i.on("error",function(aC){console.log("basemap gallery error:  ",aC)});ac=new s();ac.layerId="Zoning";M=new s();M.layerId="Protected Species";ah=new s();ah.layerId="Growth Areas";h=new s();h.layerId="Edge of Pavement";legSourceWater=new s();legSourceWater.layerId="Source Water Prot. Areas";var an,aA,F,C,U,av,X,q,b,ae,d,e,r,V;var k=0;function c(){if(k>0){app.printer.destroy()}k+=1;var aD;var aH=aa.byId("mapTitle");var aC="Data from Garrett County Office of Planning and Land Management. Accuracy is not guaranteed (see https://maps.garrettcounty.org/).";var aE="Title and Graphics created by User at "+ip;aD=aH.get("value");var aG=[{name:"Letter ANSI A Landscape",label:"Landscape (PDF)",format:"pdf",options:{legendLayers:[ac,M,ah,h,legSourceWater],scalebarUnit:"Miles",titleText:aD+", Landscape PDF",copyrightText:aE,authorText:aC}},{name:"Letter ANSI A Portrait",label:"Portrait (Image)",format:"jpg",options:{legendLayers:[ac,M,ah,h,legSourceWater],scaleBarUnit:"Miles",titleText:aD+", Portrait JPG",copyrightText:aE,authorText:aC}},{name:"Letter ANSI A Landscape",label:"Landscape (Image)",format:"jpg",options:{legendLayers:[ac,M,ah,h,legSourceWater],scaleBarUnit:"Miles",titleText:aD+", Landscape JPG",copyrightText:aE,authorText:aC}},{name:"Letter ANSI A Portrait",label:"Portrait (PDF)",format:"pdf",options:{legendLayers:[ac,M,ah,h,legSourceWater],scaleBarUnit:"Miles",titleText:aD+", Portrait PDF",copyrightText:aE,authorText:aC}}];var aF=g.map(aG,function(aJ){var aI=new ap();aI.layout=aJ.name;aI.label=aJ.label;aI.format=aJ.format;aI.layoutOptions=aJ.options;return aI});app.printer=new m({map:app.map,templates:aF,url:"https://maps.garrettcounty.org/arcweb/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task"},y.byId("printButton"));app.printer.startup()}G(y.byId("prepMap"),"click",c);G(y.byId("clearGraphics"),"click",ax);G(y.byId("textLabel"),"click",au);var u,E,af,K,aB,aj,I;u=new aw();u.layerIds=[1,4,5,6,7];u.layerOption=aw.LAYER_OPTION_SHOW;E=new aw();E.layerIds=[2,7];E.layerOption=aw.LAYER_OPTION_SHOW;I="RDNAMELOCAL";af=new aw();af.layerIds=[2,3,4,5,6,7,8,9];af.layerOption=aw.LAYER_OPTION_SHOW;K=new aw();K.layerIds=[11,12,13,14];K.layerOption=aw.LAYER_OPTION_SHOW;aB=new aw();aB.layerIds=[0,1,2,3,4];aB.layerOption=aw.LAYER_OPTION_SHOW;an=new ai("https://maps.garrettcounty.org/arcweb/rest/services/P_and_Z/Parcels_and_Zoning/MapServer",{imageParameters:E,opacity:0.75,id:"Parcels & Addresses"});aA=new ad("https://maps.garrettcounty.org/arcweb/rest/services/P_and_Z/Parcels_and_Zoning/MapServer/3",{mode:ad.MODE_ONDEMAND,id:"Cell Towers"});F=new ad("https://maps.garrettcounty.org/arcweb/rest/services/P_and_Z/Parcels_and_Zoning/MapServer/1",{mode:ad.MODE_ONDEMAND,id:"Wind Turbines"});C=new ad("https://maps.garrettcounty.org/arcweb/rest/services/P_and_Z/Parcels_and_Zoning/MapServer/5",{mode:ad.MODE_ONDEMAND,outFields:[I],showLabels:true,id:"Street Centerlines"});U=new ad("https://maps.garrettcounty.org/arcweb/rest/services/Sensitive_Areas/Sensitive_Areas/MapServer/1",{mode:ad.MODE_ONDEMAND,id:"Perennial Streams"});av=new ad("https://maps.garrettcounty.org/arcweb/rest/services/P_and_Z/Parcels_and_Zoning/MapServer/11",{mode:ad.MODE_ONDEMAND,opacity:0.3,id:"Zoning"});X=new ad("https://maps.garrettcounty.org/arcweb/rest/services/Sensitive_Areas/Sensitive_Areas/MapServer/4",{mode:ad.MODE_ONDEMAND,opacity:0.45,id:"Source Water Prot. Areas"});q=new ad("https://maps.garrettcounty.org/arcweb/rest/services/Sensitive_Areas/Sensitive_Areas/MapServer/6",{mode:ad.MODE_ONDEMAND,opacity:0.45,id:"Protected Species"});b=new ad("https://maps.garrettcounty.org/arcweb/rest/services/Sensitive_Areas/Sensitive_Areas/MapServer/7",{mode:ad.MODE_ONDEMAND,opacity:0.75,id:"Growth Areas"});ae=new ad("https://maps.garrettcounty.org/arcweb/rest/services/FEMA/FEMA/MapServer/2",{mode:ad.MODE_ONDEMAND,id:"Flood Hazard",opacity:0.75});d=new ad("https://maps.garrettcounty.org/arcweb/rest/services/Contours_and_Plan/Contours_and_Plan/MapServer/0",{mode:ad.MODE_ONDEMAND,opacity:0.75,id:"Building Footprints"});e=new ai("https://maps.garrettcounty.org/arcweb/rest/services/Contours_and_Plan/Contours_and_Plan/MapServer",{imageParameters:af,opacity:0.75,id:"Edge of Pavement"});r=new ai("https://maps.garrettcounty.org/arcweb/rest/services/Contours_and_Plan/Contours_and_Plan/MapServer",{imageParameters:K,opacity:0.75,id:"Contours"});V=new ai("https://maps.garrettcounty.org/arcweb/rest/services/Hydrography/Hydrography/MapServer",{imageParameters:aB,opacity:0.75,id:"Hydrography"});app.map.addLayers([an,aA,F,C,U,av,X,q,b,ae,d,e,r,V]);g.forEach(["Parcels & Addresses","Cell Towers","Wind Turbines","Street Centerlines","Perennial Streams","Zoning","Source Water Prot. Areas","Protected Species","Growth Areas","Flood Hazard","Building Footprints","Edge of Pavement","Hydrography","Contours"],function(aD){new at({id:"cb_"+aD,name:"cb_"+aD,checked:true,onChange:function(aE){aE?app.map.getLayer(this.id.split("_")[1]).show():app.map.getLayer(this.id.split("_")[1]).hide()}},ab.create("input",{id:"lyr_"+aD})).placeAt(y.byId("layerToggle"));var aC=ab.create("label",{"for":"cb_"+aD,innerHTML:aD});ab.place(aC,y.byId("layerToggle"));ab.place(ab.create("br"),y.byId("layerToggle"))});app.symbols={};app.symbols.point=new A("square",10,new Y(),new x([0,255,0,0.75]));app.symbols.polyline=new Y("solid",new x([255,128,0]),2);app.symbols.polygon=new B().setColor(new x([255,255,0,0.25]));app.symbols.circle=new B().setColor(new x([0,0,180,0.25]));app.symbols.line=new Y("solid",new x([180,10,80]),2);N(".drawing").forEach(function(aD){var aC=new j({label:aD.innerHTML,onClick:function(){ag(this.id)}},aD)});var Q,l;Q=new o({data:[{name:"Flood Hazard",id:"FEMA",baseURL:"FEMA_map.php"},{name:"Measurement",id:"MSMT",baseURL:"measure.php"},{name:"Planning and Zoning",id:"PZMAP",baseURL:"pz_map.php"},{name:"Sensitive Areas",id:"SENSI",baseURL:"sensitive.php"},{name:"Printable",id:"PRINT",baseURL:"printable.php"}]});l=new t({id:"mapSelect",name:"map",value:"Printable",store:Q,searchAttr:"name"},"mapSelect").startup();function ao(){var aD=dijit.byId("mapSelect").get("value"),aE,aC,aF;switch(aD){case"Measurement":aF="_blank";aE="measure.php";break;case"Planning and Zoning":aE="pz_map.php";aF="_blank";break;case"Flood Hazard":aE="FEMA_map.php";aF="_blank";break;case"Sensitive Areas":aE="sensitive.php";aF="_blank";break;case"Printable":aE="printable.php";aF="_self";break}aC=aE+"?px="+passedX+"&py="+passedY+"&zl="+zoomLevel;window.open(aC,aF)}aa.byId("launchButton").on("click",ao);function v(aE){var aD=ay.webMercatorToGeographic(aE.getCenter());passedX=parseFloat(aD.x.toFixed(5));passedY=parseFloat(aD.y.toFixed(5));zoomLevel=app.map.getLevel();var aC=document.getElementById("centroid");aC.innerHTML="Latitude: "+passedY+"<br />Longitude: "+passedX}function ag(aC){if(aC==="label"){app.symbols.point=new A("circle",10,new Y(),new x([255,0,0,0.75]));aC="point";esri.bundle.toolbars.draw.addPoint="Add a text label";H=true}else{if(aC==="point"){app.symbols.point=new A("square",10,new Y(),new x([0,255,0,0.75]));esri.bundle.toolbars.draw.addPoint="Click to add a point";H=false}else{if(aC==="arrow"){app.symbols.arrow=new B().setColor(new x([0,0,180,0.25]))}else{if(aC==="rectangle"){app.symbols.rectangle=new B().setColor(new x([0,180,39,0.25]))}else{H=false}}}}app.tool=aC.replace("freehand","");app.toolbar.activate(aC);app.map.hideZoomSlider()}function Z(){dojo.connect(dijit.byId("map"),"resize",app.map,app.map.resize);ar=new esri.toolbars.Edit(app.map);dojo.connect(app.map.graphics,"onClick",function(aC){dojo.stopEvent(aC);z(aC.graphic)});dojo.connect(app.map,"onClick",function(aC){ar.deactivate()})}function z(aD){var aC={allowAddVertices:true,allowDeleteVertices:true};ar.activate(esri.toolbars.Edit.EDIT_VERTICES|esri.toolbars.Edit.ROTATE,aD,aC)}function D(aD){var aI,aG,aF,aH,aJ,aC;var aE=new aq("20px",aq.STYLE_NORMAL,aq.VARIANT_NORMAL,aq.WEIGHT_BOLDER,"Ariel");app.toolbar.deactivate();app.map.showZoomSlider();if(H){aI=prompt("Enter a Text Label","");aF=aa.byId("includeCoords");if(aF.get("checked")){aH="Lat: "+mpArray[1]+", Long: "+mpArray[0]+"  -  "+aI}else{aH=aI}aG=new J(aH,aE,new x([0,0,0]));aJ=new az(aD.geometry,aG);aC=new az(aD.geometry,app.symbols[app.tool]);app.map.graphics.add(aJ);app.map.graphics.add(aC)}else{aJ=new az(aD.geometry,app.symbols[app.tool]);app.map.graphics.add(aJ)}H=false}geocoders=[{url:"https://geodata.md.gov/imap/rest/services/GeocodeServices/MD_CompositeLocator/GeocodeServer",name:"MDiMap Composite Locator",singleLineFieldName:"SingleLine"}];geocoder=new S({map:app.map,geocoders:geocoders,arcgisGeocoder:false},"geosearch");geocoder.startup()});