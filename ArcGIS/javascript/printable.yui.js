var app={};var mpArray;var passedCenter;app.map=null;app.toolbar=null;app.tool=null;app.symbols=null;app.printer=null;require(["esri/map","esri/toolbars/draw","esri/toolbars/edit","esri/dijit/Scalebar","esri/dijit/Print","esri/dijit/Geocoder","esri/dijit/BasemapGallery","esri/geometry/webMercatorUtils","esri/geometry/Point","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/ArcGISDynamicMapServiceLayer","esri/layers/FeatureLayer","esri/layers/ImageParameters","esri/layers/GraphicsLayer","esri/layers/LabelClass","esri/tasks/PrintTemplate","esri/tasks/LegendLayer","esri/symbols/SimpleMarkerSymbol","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/TextSymbol","esri/symbols/Font","esri/renderers/SimpleRenderer","esri/graphic","esri/config","dojo/_base/array","esri/Color","dojo/parser","dojo/query","dojo/dom","dojo/on","dojo/dom-construct","dojo/store/Memory","dijit/registry","dijit/form/CheckBox","dijit/form/ComboBox","dijit/form/Button","dijit/layout/BorderContainer","dijit/layout/ContentPane","dijit/TitlePane","dojox/layout/ExpandoPane","dojo/domReady!"],function(B,au,aA,k,q,Z,av,aG,i,ab,aq,al,aE,ae,g,ay,w,F,ag,G,P,az,r,aH,T,j,C,Y,S,D,L,aj,s,ai,aB,y,n,t){Y.parse();T.defaults.io.proxyUrl="/proxy";var m,ak,R,ap,l,d;var M=false;passedCenter=[passedX,passedY];app.map=new B("map",{basemap:"streets",center:passedCenter,showLabels:true,zoom:zoomLevel});function Q(){var aO,aN,aS,aR,aP,aL,aQ,aM;aO=document.getElementById("textLatLong").value;aO=aO.replace(/\s+/g,"");aN=aO.indexOf(",");if(aN>0){aS=parseFloat(aO.slice(0,aN));aR=parseFloat(aO.substring(aN+1));aP=new F(F.STYLE_SQUARE,12,new ag(ag.STYLE_SOLID,new C([10,10,10,0.75]),1),new C([255,0,0,0.5]));aL=new i(aR,aS,map.spatialRefernce);aQ=new aH(aL,aP,null,null);app.map.graphics.add(aQ);if(aQ.geometry.type==="point"){aM=app.map.getMaxZoom();app.map.centerAndZoom(aQ.geometry,aM-1)}else{app.map.setExtent(graphicsUtils.graphicsExtent([aQ]))}}else{return""}}function b(aM){var aL=document.getElementById("textLatLong");aL.value=aM.coords.latitude+", "+aM.coords.longitude}function U(){app.map.graphics.clear();var aL=document.getElementById("centroid");if(navigator.geolocation){navigator.geolocation.getCurrentPosition(b)}else{aL.innerHTML="Geolocation is not supported by this browser."}}L(D.byId("getLocationButton"),"click",U);app.map.on("load",function(){app.toolbar=new au(app.map);app.toolbar.on("draw-end",I);app.map.on("mouse-move",at);app.map.on("mouse-drag",at);dojo.connect(app.map,"onExtentChange",A);L(D.byId("submitLatLongButton"),"click",Q);ah(app.map)});function aF(){app.map.graphics.clear()}function at(aL){var aM=aG.webMercatorToGeographic(aL.mapPoint);D.byId("coordsinfo").innerHTML=aM.y.toFixed(5)+", "+aM.x.toFixed(5);mpArray=[aM.x.toFixed(5),aM.y.toFixed(5)]}function aC(){app.toolbar=new au(app.map);ao("label");app.toolbar.on("draw-end",I);L.once(D.byId("map"),"click",at)}d=new k({map:app.map,attachTo:"bottom-right",scalebarStyle:"line",scalebarUnit:"english"});m=new av({showArcGISBasemaps:true,map:app.map},"basemapGallery");mdImagelayer=new esri.layers.ArcGISTiledMapServiceLayer("https://geodata.md.gov/imap/rest/services/Imagery/MD_SixInchImagery/ImageServer");mdImage2011=new esri.layers.ArcGISTiledMapServiceLayer("https://imagery.geodata.md.gov/imap/rest/services/SixInch/SixInchImagery2011_2013/MapServer");mdImageBasemap=new esri.dijit.Basemap({layers:[mdImagelayer],title:"MD 2014 Imagery",thumbnailUrl:"https://maps.garrettcounty.org/arcgis/images/image2014.png"});mdImageBasemap2011=new esri.dijit.Basemap({layers:[mdImage2011],title:"MD 2011 Imagery",thumbnailUrl:"https://maps.garrettcounty.org/arcgis/images/image_v2.png"});m.add(mdImageBasemap);m.add(mdImageBasemap2011);m.startup();m.on("error",function(aL){console.log("basemap gallery error:  ",aL)});ak=new w();ak.layerId="Zoning";R=new w();R.layerId="Protected Species";ap=new w();ap.layerId="Growth Areas";l=new w();l.layerId="Edge of Pavement";legSourceWater=new w();legSourceWater.layerId="Source Water Prot. Areas";var aw,aI,K,H,ac,aD,af,u,c,am,f,h,v,ad,x,X;var o=0;function e(){if(o>0){app.printer.destroy()}o+=1;var aM;var aQ=ai.byId("mapTitle");var aL="Data from Garrett County Office of Planning and Land Management. Accuracy is not guaranteed (see https://maps.garrettcounty.org/).";var aN="Title and Graphics created by User at "+ip;aM=aQ.get("value");var aP=[{name:"Letter ANSI A Landscape",label:"Landscape (PDF)",format:"pdf",options:{legendLayers:[ak,R,ap,l,legSourceWater],scalebarUnit:"Miles",titleText:aM+", Landscape PDF",copyrightText:aN,authorText:aL}},{name:"Letter ANSI A Portrait",label:"Portrait (Image)",format:"jpg",options:{legendLayers:[ak,R,ap,l,legSourceWater],scaleBarUnit:"Miles",titleText:aM+", Portrait JPG",copyrightText:aN,authorText:aL}},{name:"Letter ANSI A Landscape",label:"Landscape (Image)",format:"jpg",options:{legendLayers:[ak,R,ap,l,legSourceWater],scaleBarUnit:"Miles",titleText:aM+", Landscape JPG",copyrightText:aN,authorText:aL}},{name:"Letter ANSI A Portrait",label:"Portrait (PDF)",format:"pdf",options:{legendLayers:[ak,R,ap,l,legSourceWater],scaleBarUnit:"Miles",titleText:aM+", Portrait PDF",copyrightText:aN,authorText:aL}}];var aO=j.map(aP,function(aS){var aR=new ay();aR.layout=aS.name;aR.label=aS.label;aR.format=aS.format;aR.layoutOptions=aS.options;return aR});app.printer=new q({map:app.map,templates:aO,url:"https://maps.garrettcounty.org/arcweb/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task"},D.byId("printButton"));app.printer.startup()}L(D.byId("prepMap"),"click",e);L(D.byId("clearGraphics"),"click",aF);L(D.byId("textLabel"),"click",aC);var z,J,an,O,aK,ar,N;z=new aE();z.layerIds=[1,4,5,6,7];z.layerOption=aE.LAYER_OPTION_SHOW;J=new aE();J.layerIds=[2,7];J.layerOption=aE.LAYER_OPTION_SHOW;N="RDNAMELOCAL";an=new aE();an.layerIds=[2,3,4,5,6,7,8,9];an.layerOption=aE.LAYER_OPTION_SHOW;O=new aE();O.layerIds=[11,12,13,14];O.layerOption=aE.LAYER_OPTION_SHOW;aK=new aE();aK.layerIds=[0,1,2,3,4];aK.layerOption=aE.LAYER_OPTION_SHOW;soParameters=new aE();soParameters.layerIds=[0];soParameters.layerOption=aE.LAYER_OPTION_SHOW;aw=new aq("https://maps.garrettcounty.org/arcweb/rest/services/P_and_Z/Parcels_and_Zoning/MapServer",{imageParameters:J,opacity:0.75,id:"Parcels & Addresses"});aI=new al("https://maps.garrettcounty.org/arcweb/rest/services/P_and_Z/Parcels_and_Zoning/MapServer/3",{mode:al.MODE_ONDEMAND,id:"Cell Towers"});K=new al("https://maps.garrettcounty.org/arcweb/rest/services/P_and_Z/Parcels_and_Zoning/MapServer/1",{mode:al.MODE_ONDEMAND,id:"Wind Turbines"});H=new al("https://maps.garrettcounty.org/arcweb/rest/services/P_and_Z/Parcels_and_Zoning/MapServer/5",{mode:al.MODE_ONDEMAND,outFields:[N],showLabels:true,id:"Street Centerlines"});ac=new al("https://maps.garrettcounty.org/arcweb/rest/services/Sensitive_Areas/Sensitive_Areas/MapServer/1",{mode:al.MODE_ONDEMAND,id:"Perennial Streams"});aD=new al("https://maps.garrettcounty.org/arcweb/rest/services/P_and_Z/Parcels_and_Zoning/MapServer/11",{mode:al.MODE_ONDEMAND,opacity:0.3,id:"Zoning"});af=new al("https://maps.garrettcounty.org/arcweb/rest/services/Sensitive_Areas/Sensitive_Areas/MapServer/4",{mode:al.MODE_ONDEMAND,opacity:0.45,id:"Source Water Prot. Areas"});u=new al("https://maps.garrettcounty.org/arcweb/rest/services/Sensitive_Areas/Sensitive_Areas/MapServer/6",{mode:al.MODE_ONDEMAND,opacity:0.45,id:"Protected Species"});c=new al("https://maps.garrettcounty.org/arcweb/rest/services/Sensitive_Areas/Sensitive_Areas/MapServer/7",{mode:al.MODE_ONDEMAND,opacity:0.75,id:"Growth Areas"});am=new al("https://maps.garrettcounty.org/arcweb/rest/services/FEMA/FEMA/MapServer/2",{mode:al.MODE_ONDEMAND,id:"Flood Hazard",opacity:0.75});f=new al("https://maps.garrettcounty.org/arcweb/rest/services/Contours_and_Plan/Contours_and_Plan/MapServer/0",{mode:al.MODE_ONDEMAND,opacity:0.75,id:"Building Footprints"});h=new aq("https://maps.garrettcounty.org/arcweb/rest/services/Contours_and_Plan/Contours_and_Plan/MapServer",{imageParameters:an,opacity:0.75,id:"Edge of Pavement"});v=new aq("https://maps.garrettcounty.org/arcweb/rest/services/Contours_and_Plan/Contours_and_Plan/MapServer",{imageParameters:O,opacity:0.75,id:"Contours"});ad=new aq("https://maps.garrettcounty.org/arcweb/rest/services/Hydrography/Hydrography/MapServer",{imageParameters:aK,opacity:0.75,id:"Hydrography"});x=new al("http://geodata.md.gov/imap/rest/services/Geoscientific/MD_SSURGOSoils/MapServer/0",{mode:al.MODE_ONDEMAND,id:"SSurgo Soils",outFields:["MUSYM"],showLabels:true,opacity:0.75});X=new al("http://geodata.md.gov/imap/rest/services/Hydrology/MD_Wetlands/MapServer/3/",{mode:al.MODE_ONDEMAND,id:"Wetlands of State Concern",opacity:0.75});var aa=new C([255,170,0,255]);var V=new P().setColor(aa);V.font.setSize("14pt");V.font.setFamily("tahoma");var a={labelExpressionInfo:{value:"{MUSYM}"}};var aJ=new g(a);aJ.symbol=V;x.setLabelingInfo([aJ]);app.map.addLayers([aw,aI,K,H,ac,aD,af,u,c,am,f,h,v,ad,x,X]);j.forEach(["Parcels & Addresses","Cell Towers","Wind Turbines","Street Centerlines","Perennial Streams","Zoning","Source Water Prot. Areas","Protected Species","Growth Areas","Flood Hazard","Building Footprints","Edge of Pavement","Hydrography","Contours","SSurgo Soils","Wetlands of State Concern"],function(aM){new aB({id:"cb_"+aM,name:"cb_"+aM,checked:true,onChange:function(aN){aN?app.map.getLayer(this.id.split("_")[1]).show():app.map.getLayer(this.id.split("_")[1]).hide()}},aj.create("input",{id:"lyr_"+aM})).placeAt(D.byId("layerToggle"));var aL=aj.create("label",{"for":"cb_"+aM,innerHTML:aM});aj.place(aL,D.byId("layerToggle"));aj.place(aj.create("br"),D.byId("layerToggle"))});app.symbols={};app.symbols.point=new F("square",10,new ag(),new C([0,255,0,0.75]));app.symbols.polyline=new ag("solid",new C([255,128,0]),2);app.symbols.polygon=new G().setColor(new C([255,255,0,0.25]));app.symbols.circle=new G().setColor(new C([0,0,180,0.25]));app.symbols.line=new ag("solid",new C([180,10,80]),2);S(".drawing").forEach(function(aM){var aL=new n({label:aM.innerHTML,onClick:function(){ao(this.id)}},aM)});var W,p;W=new s({data:[{name:"Flood Hazard",id:"FEMA",baseURL:"FEMA_map.php"},{name:"Measurement",id:"MSMT",baseURL:"measure.php"},{name:"Planning and Zoning",id:"PZMAP",baseURL:"pz_map.php"},{name:"Sensitive Areas",id:"SENSI",baseURL:"sensitive.php"},{name:"Printable",id:"PRINT",baseURL:"printable.php"}]});p=new y({id:"mapSelect",name:"map",value:"Printable",store:W,searchAttr:"name"},"mapSelect").startup();function ax(){var aM=dijit.byId("mapSelect").get("value"),aN,aL,aO;switch(aM){case"Measurement":aO="_blank";aN="measure.php";break;case"Planning and Zoning":aN="pz_map.php";aO="_blank";break;case"Flood Hazard":aN="FEMA_map.php";aO="_blank";break;case"Sensitive Areas":aN="sensitive.php";aO="_blank";break;case"Printable":aN="printable.php";aO="_self";break}aL=aN+"?px="+passedX+"&py="+passedY+"&zl="+zoomLevel;window.open(aL,aO)}ai.byId("launchButton").on("click",ax);function A(aN){var aM=aG.webMercatorToGeographic(aN.getCenter());passedX=parseFloat(aM.x.toFixed(5));passedY=parseFloat(aM.y.toFixed(5));zoomLevel=app.map.getLevel();var aL=document.getElementById("centroid");aL.innerHTML="Latitude: "+passedY+"<br />Longitude: "+passedX}function ao(aL){if(aL==="label"){app.symbols.point=new F("circle",10,new ag(),new C([255,0,0,0.75]));aL="point";esri.bundle.toolbars.draw.addPoint="Add a text label";M=true}else{if(aL==="point"){app.symbols.point=new F("square",10,new ag(),new C([0,255,0,0.75]));esri.bundle.toolbars.draw.addPoint="Click to add a point";M=false}else{if(aL==="arrow"){app.symbols.arrow=new G().setColor(new C([0,0,180,0.25]))}else{if(aL==="rectangle"){app.symbols.rectangle=new G().setColor(new C([0,180,39,0.25]))}else{M=false}}}}app.tool=aL.replace("freehand","");app.toolbar.activate(aL);app.map.hideZoomSlider()}function ah(){dojo.connect(dijit.byId("map"),"resize",app.map,app.map.resize);aA=new esri.toolbars.Edit(app.map);dojo.connect(app.map.graphics,"onClick",function(aL){dojo.stopEvent(aL);E(aL.graphic)});dojo.connect(app.map,"onClick",function(aL){aA.deactivate()})}function E(aM){var aL={allowAddVertices:true,allowDeleteVertices:true};aA.activate(esri.toolbars.Edit.EDIT_VERTICES|esri.toolbars.Edit.ROTATE,aM,aL)}function I(aM){var aR,aP,aO,aQ,aS,aL;var aN=new az("20px",az.STYLE_NORMAL,az.VARIANT_NORMAL,az.WEIGHT_BOLDER,"Ariel");app.toolbar.deactivate();app.map.showZoomSlider();if(M){aR=prompt("Enter a Text Label","");aO=ai.byId("includeCoords");if(aO.get("checked")){aQ="Lat: "+mpArray[1]+", Long: "+mpArray[0]+"  -  "+aR}else{aQ=aR}aP=new P(aQ,aN,new C([0,0,0]));aS=new aH(aM.geometry,aP);aL=new aH(aM.geometry,app.symbols[app.tool]);app.map.graphics.add(aS);app.map.graphics.add(aL)}else{aS=new aH(aM.geometry,app.symbols[app.tool]);app.map.graphics.add(aS)}M=false}geocoders=[{url:"https://geodata.md.gov/imap/rest/services/GeocodeServices/MD_CompositeLocator/GeocodeServer",name:"MDiMap Composite Locator",singleLineFieldName:"SingleLine"}];geocoder=new Z({map:app.map,geocoders:geocoders,arcgisGeocoder:false},"geosearch");geocoder.startup()});