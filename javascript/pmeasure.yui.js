var map,console,require;var passedCenter,passedX,passedY,zoomLevel;require(["dojo/dom","esri/Color","dojo/keys","dojo/parser","esri/layers/ArcGISDynamicMapServiceLayer","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/ImageParameters","esri/dijit/BasemapGallery","esri/config","esri/sniff","esri/map","esri/tasks/GeometryService","esri/dijit/Scalebar","esri/dijit/Basemap","esri/SnappingManager","esri/dijit/Measurement","esri/geometry/webMercatorUtils","esri/layers/FeatureLayer","esri/renderers/SimpleRenderer","esri/symbols/SimpleLineSymbol","esri/symbols/SimpleFillSymbol","dojo/store/Memory","dijit/form/ComboBox","dijit/registry","dijit/layout/BorderContainer","dijit/layout/ContentPane","dijit/TitlePane","esri/dijit/Geocoder","dojo/domReady!"],function(f,p,C,E,q,w,T,J,v,h,o,R,A,I,M,u,F,K,y,z,d,B,x,P,S,j,c,L){E.parse();var i,a,g,m,l,D,b,Q,e,n,t,H,r;var s,O;v.defaults.io.proxyUrl="/proxy";v.defaults.io.alwaysUseProxy=false;v.defaults.geometryService=new R("http://tasks.arcgisonline.com/ArcGIS/rest/services/Geometry/GeometryServer");function N(){var V=dijit.byId("mapSelect").get("value"),W,U,X;switch(V){case"Measurement":X="_self";W="measure.php";break;case"Planning and Zoning":W="pz_map.php";X="_blank";break;case"Flood Hazard":W="FEMA_map.php";X="_blank";break;case"Sensitive Areas":W="sensitive.php";X="_blank";break;case"Printable":W="printable.php";X="_blank";break}var U=W+"?px="+passedX+"&py="+passedY+"&zl="+zoomLevel;window.open(U,X)}passedCenter=[passedX,passedY];P.byId("launchButton").on("click",N);function k(){dojo.connect(map,"onExtentChange",G)}map=new o("map",{basemap:"streets",center:passedCenter,zoom:zoomLevel});i=new J({showArcGISBasemaps:true,map:map},"basemapGallery");a=new A({map:map,attachTo:"bottom-right",scalebarStyle:"line",scalebarUnit:"english"});map.on("load",k);var s=new B({data:[{name:"Flood Hazard",id:"FEMA",baseURL:"FEMA_map.php"},{name:"Measurement",id:"MSMT",baseURL:"measure.php"},{name:"Planning and Zoning",id:"PZMAP",baseURL:"pz_map.php"},{name:"Sensitive Areas",id:"SENSI",baseURL:"sensitive.php"},{name:"Printable",id:"PRINT",baseURL:"printable.php"}]});var O=new x({id:"mapSelect",name:"map",value:"Measurement",store:s,searchAttr:"name"},"mapSelect").startup();function G(V){var U=F.webMercatorToGeographic(map.extent.getCenter());passedX=parseFloat(U.x.toFixed(5));passedY=parseFloat(U.y.toFixed(5));zoomLevel=map.getLevel()}g=new esri.layers.ArcGISTiledMapServiceLayer("http://geodata.md.gov/imap/rest/services/Imagery/MD_SixInchImagery/ImageServer");mdImage2011=new esri.layers.ArcGISTiledMapServiceLayer("http://imagery.geodata.md.gov/imap/rest/services/SixInch/SixInchImagery2011_2013/MapServer");m=new esri.dijit.Basemap({layers:[g],title:"MD 2014 Imagery",thumbnailUrl:"http://maps.garrettcounty.org/arcgis/images/image2014.png"});mdImageBasemap2011=new esri.dijit.Basemap({layers:[mdImage2011],title:"MD 2011 Imagery",thumbnailUrl:"http://maps.garrettcounty.org/arcgis/images/image_v2.png"});i.add(m);i.add(mdImageBasemap2011);i.startup();i.on("error",function(U){console.log("basemap gallery error:  ",U)});l=new d("solid",new z("solid",new p([195,176,23]),2),null);D=new T();D.layerIds=[1,4,5,6,8];D.layerOption=T.LAYER_OPTION_SHOW;b=new q("http://maps.garrettcounty.org:6080/arcgis/rest/services/P_and_Z/Parcels_and_Zoning/MapServer",{imageParameters:D,opacity:0.55});map.addLayer(b);Q=new K("http://maps.garrettcounty.org:6080/arcgis/rest/services/P_and_Z/Parcels_and_Zoning/MapServer/8",{mode:K.MODE_ONDEMAND,outFields:["*"]});Q.setRenderer(new y(l));map.addLayers([Q]);e=map.enableSnapping({snapKey:h("mac")?C.META:C.CTRL});n=[{layer:Q}];e.setLayerInfos(n);t=new u({map:map},f.byId("measurementDiv"));t.startup();H=[{url:"http://geodata.md.gov/imap/rest/services/GeocodeServices/MD_AddressPointLocator/GeocodeServer",name:"iMap GeoCoder"}];r=new L({map:map,geocoders:H,arcgisGeocoder:false},"geosearch");r.startup()});